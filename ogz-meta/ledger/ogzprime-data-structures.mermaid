---
title: OGZPrime â€” Key Data Structures Reference
---

%% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
%% This diagram shows WHAT DATA LOOKS LIKE at each stage.
%% Use the Architecture diagram for HOW things connect.
%% â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

flowchart LR
    subgraph CANDLE["ğŸ“Š Candle Object"]
        direction TB
        C1["{<br/>  o: 97542.1,  // open<br/>  h: 97598.3,  // high<br/>  l: 97501.0,  // low<br/>  c: 97567.8,  // close<br/>  v: 12.453,   // volume<br/>  t: 1707000000000,  // start time ms<br/>  etime: 1707000060000  // end time ms<br/>}"]
    end

    subgraph INDICATORS["ğŸ“ˆ IndicatorEngine.getSnapshot()"]
        direction TB
        I1["{<br/>  rsi: 58.4,<br/>  macd: { macd: 12.3, signal: 10.1, histogram: 2.2 },<br/>  ema20: 97500, ema50: 97200, ema200: 95800,<br/>  bollinger: { upper: 98000, middle: 97300, lower: 96600 },<br/>  atr: 245.6,<br/>  adx: 28.3,<br/>  obv: 1234567,<br/>  vwap: 97450,<br/>  momentum: 0.02,<br/>  trendStrength: 0.65,<br/>  trend: 'bullish' | 'bearish' | 'neutral'<br/>}"]
    end

    subgraph PATTERN["ğŸ” PatternRecognition Result"]
        direction TB
        P1["[{<br/>  name: 'bullish_engulfing',<br/>  confidence: 0.78,<br/>  direction: 'bullish',<br/>  description: '...'<br/>}, ...]"]
    end

    subgraph REGIME["ğŸŒ¡ï¸ MarketRegimeDetector Result"]
        direction TB
        R1["'trending_up' | 'trending_down' |<br/>'ranging' | 'volatile' | 'breakout'"]
    end

    subgraph BRAIN_DEC["ğŸ§  TradingBrain.getDecision()"]
        direction TB
        BD1["{<br/>  action: 'BUY' | 'SELL' | 'HOLD',<br/>  confidence: 0.72,<br/>  direction: 'bullish' | 'bearish',<br/>  reasons: ['Strong RSI divergence', ...],<br/>  fibLevels: {...},<br/>  srLevels: {...}<br/>}"]
    end

    subgraph TRAI_DEC["ğŸ¤– TRAI Decision"]
        direction TB
        TD1["{<br/>  action: 'BUY' | 'SELL' | 'HOLD' | 'VETO',<br/>  confidence: 0.68,<br/>  reasoning: '...',<br/>  veto: false,<br/>  vetoReason: null,<br/>  riskAssessment: { score: 0.3, factors: [...] }<br/>}"]
    end

    subgraph STATE["ğŸ’¾ StateManager (SINGLETON)"]
        direction TB
        S1["{<br/>  position: 0.00523,  // BTC amount (0 = no position)<br/>  balance: 10247.83, // USD<br/>  activeTrades: Map {orderId â†’ tradeObj},<br/>  isPaused: false,<br/>  dailyPnL: 47.23,<br/>  weeklyPnL: 182.50,<br/>  monthlyPnL: 891.20,<br/>  totalTrades: 342,<br/>  winRate: 0.67<br/>}"]
    end

    subgraph TRADE_OBJ["ğŸ“ Active Trade Object"]
        direction TB
        T1["{<br/>  orderId: 'OGZ-1707000000-abc',<br/>  type: 'BUY',<br/>  entryPrice: 97542.10,<br/>  size: 0.00523,  // in base currency<br/>  confidence: 0.72,<br/>  timestamp: 1707000000000,<br/>  patterns: ['bullish_engulfing'],<br/>  regime: 'trending_up',<br/>  indicators: { rsi: 58.4, ... }<br/>}"]
    end

    subgraph EXEC_REQ["âš¡ ExecutionLayer Request"]
        direction TB
        E1["{<br/>  direction: 'buy' | 'sell',<br/>  positionSize: 0.00523,<br/>  confidence: 0.72,<br/>  marketData: { symbol: 'BTC/USD', price: 97542 },<br/>  decisionId: 'trai-abc123',<br/>  meta: { patterns, regime, reasons }<br/>}"]
    end

    subgraph KRAKEN_ORDER["ğŸ“¤ Kraken Order (via adapter)"]
        direction TB
        K1["{<br/>  pair: 'XXBTZUSD',  // convertToKrakenSymbol()<br/>  type: 'buy' | 'sell',<br/>  ordertype: 'market' | 'limit',<br/>  volume: '0.00523'  // string!<br/>}"]
    end

    subgraph WS_MSGS["ğŸ“¡ Dashboard WS Messages"]
        direction TB
        W1["Bot â†’ Dashboard:<br/>â€¢ {type:'market_update', price, indicators, patterns, regime}<br/>â€¢ {type:'trade_executed', trade, orderId, ...}<br/>â€¢ {type:'trade_closed', pnl, ...}<br/>â€¢ {type:'state_update', position, balance, ...}<br/>â€¢ {type:'historical_candles', timeframe, candles[]}<br/>â€¢ {type:'chain_of_thought', ...TRAI reasoning}<br/>â€¢ {type:'pattern_analysis', patterns[], ...}<br/>â€¢ {type:'asset_switched', asset, label, ...}<br/><br/>Dashboard â†’ Bot:<br/>â€¢ {type:'asset_change', asset:'ETH-USD'}<br/>â€¢ {type:'timeframe_change', timeframe:'5m'}<br/>â€¢ {type:'request_historical', timeframe, limit}<br/>â€¢ {type:'command', command:'pause_trading'|'resume_trading'|<br/>  'switch_profile'|'set_confidence'|'get_profiles'}<br/>â€¢ {type:'trai_query', message:'...'}"]
    end

    subgraph BOT_PROPS["ğŸ¤– Bot Instance Properties (this.xxx)"]
        direction TB
        BP1["Data:<br/>â€¢ priceHistory â€” Candle[] (max 200, 1m)<br/>â€¢ timeframeHistories â€” {tf: Candle[]} per timeframe<br/>â€¢ marketData â€” latest raw OHLC from Kraken<br/>â€¢ edgeAnalytics â€” {cvd, momentum, volatility}<br/>â€¢ rsiHistory â€” number[] (last 3)<br/>â€¢ marketRegime â€” string<br/>â€¢ confidenceHistory â€” number[]<br/><br/>Config:<br/>â€¢ config.tradingPair â€” 'BTC-USD'<br/>â€¢ tradingPair â€” 'BTC/USD' (slash format)<br/>â€¢ config.symbol â€” 'BTC'<br/>â€¢ tier â€” 'core' | 'ml'<br/>â€¢ mode â€” 'paper' | 'live'<br/><br/>Connections:<br/>â€¢ kraken â€” KrakenIBrokerAdapter<br/>â€¢ dashboardWs â€” WebSocket to SSL server<br/>â€¢ dashboardWsConnected â€” bool<br/><br/>Modules:<br/>â€¢ tradingBrain â€” OptimizedTradingBrain<br/>â€¢ riskManager â€” RiskManager<br/>â€¢ executionLayer â€” AdvancedExecutionLayer<br/>â€¢ regimeDetector â€” MarketRegimeDetector<br/>â€¢ patternChecker â€” EnhancedPatternRecognition<br/>â€¢ trai â€” TRAIDecisionModule<br/>â€¢ profileManager â€” TradingProfileManager<br/>â€¢ rateLimiter â€” ExecutionRateLimiter<br/>â€¢ ogzTpo â€” OgzTpoIntegration<br/>â€¢ performanceAnalyzer â€” PerformanceAnalyzer<br/>â€¢ gridStrategy â€” GridTradingStrategy<br/>â€¢ tradeIntelligence â€” TradeIntelligenceEngine<br/>â€¢ patternExitModel â€” PatternBasedExitModel<br/>â€¢ messageQueue â€” MessageQueue<br/>â€¢ tierFlagManager â€” TierFeatureFlags<br/>â€¢ assetManager â€” MultiAssetManager"]
    end

    %% Flow connections
    C1 --> I1
    C1 --> P1
    C1 --> R1
    I1 --> BD1
    P1 --> BD1
    R1 --> BD1
    BD1 --> TD1
    TD1 --> E1
    E1 --> K1
    S1 --- T1

    classDef data fill:#1a1a2e,stroke:#e94560,color:#fff
    classDef state fill:#e94560,stroke:#fff,color:#fff
    classDef msg fill:#533483,stroke:#e94560,color:#fff

    class C1,I1,P1,R1,BD1,TD1,E1,K1,T1 data
    class S1 state
    class W1,BP1 msg
